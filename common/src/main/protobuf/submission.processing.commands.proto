syntax = "proto3";

option java_package = "hmda.persistence.serialization";
option optimize_for = SPEED;

import "submission.proto";
import "validation.proto";

message StartUploadMessage {
    SubmissionIdMessage submissionId = 1;
}

message CompleteUploadMessage {
    SubmissionIdMessage submissionId = 1;
}

message StartParsingMessage {
    SubmissionIdMessage submissionId = 1;
}

message PersistHmdaRowParsedErrorMessage {
    int32 rowNumber = 1;
    repeated string errors = 2;
    string maybeReplyTo = 3;
}

message PersistHmdaRowValidatedErrorMessage {
    int32 rowNumber = 1;
    ValidationErrorMessage validationError = 2;
    string replyTo = 3;
}

message GetParsedWithErrorCountMessage {
    string replyTo = 1;
}

message CompleteParsingMessage {
    SubmissionIdMessage submissionId = 1;
}

message CompleteParsingWithErrorsMessage {
    SubmissionIdMessage submissionId = 1;
}

message StartSyntacticalValidityMessage {
    SubmissionIdMessage submissionId = 1;
}

message GetHmdaValidationErrorStateMessage {
    SubmissionIdMessage submissionId = 1;
    string replyTo = 2;
}

message HmdaValidationErrorStateMessage {
    int32 totalErrors = 1;
    int32 syntacticalErrors = 2;
    int32 validityErrors = 3;
    int32 qualityErrors = 4;
    int32 macroErrors = 5;
}